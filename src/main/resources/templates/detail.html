<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chi tiết sản phẩm</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <!-- AOS Animate On Scroll -->
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/detail.css}" />
  </head>
  <body>
    <th:block th:object="${product}">
      <div class="container">
        <div class="row ms-5 ps-5 me-5 pe-5 g-lg-3">
          <div class="col-md-6 mb-4">
            <div class="image-viewer">
              <img
                th:src="@{/images/{image}(image=*{image_url})}"
                class="main-image"
                id="main-image"
                data-bs-toggle="modal"
                data-bs-target="#imageModal"
              />
            </div>

            <div class="thumbnail-container">
              <img
                th:src="@{/images/{image}(image=*{image_url})}"
                alt="Angle 1"
                class="thumbnail active"
                th:data-image="@{/images/{image}(image=*{image_url})}"
              />
              <img
                th:src="@{/images/{image}(image=*{image_url2})}"
                alt="Angle 2"
                class="thumbnail"
                th:data-image="@{/images/{image}(image=*{image_url2})}"
              />
              <img
                th:src="@{/images/{image}(image=*{image_url3})}"
                alt="Angle 3"
                class="thumbnail"
                th:data-image="@{/images/{image}(image=*{image_url3})}"
              />
            </div>
          </div>

          <div class="col-md-6 product">
            <h3 class="product-title" th:text="*{name}"></h3>

            <!-- Giá sản phẩm: Có giảm giá -->
            <th:block th:if="*{priceAfterDiscount lt price}">
              <div class="product-price">
                <h3
                  class="text-black"
                  th:text="${#numbers.formatDecimal(product.priceAfterDiscount, 0, 'COMMA', 0, 'POINT')} + ' VND'"
                ></h3>
                <em
                  class="text-danger text-decoration-line-through"
                  th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + ' VND'"
                ></em>
              </div>
            </th:block>

            <!-- Giá sản phẩm: Không giảm giá -->
            <th:block th:if="*{priceAfterDiscount eq price}">
              <div
                class="product-price text-muted"
                th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + ' VND'"
              ></div>
            </th:block>

            <div class="button-group">
              <form th:action="@{/cart/add}" method="post">
                <input
                  type="hidden"
                  name="productId"
                  th:value="${product.id}"
                />
                <input
                  type="number"
                  name="quantity"
                  value="1"
                  step="1"
                  min="1"
                  class="btn btn-light w-5 m-3"
                />
                <br />
                <button
                  type="submit"
                  class="btn-order btn btn-sm rounded-pill"
                  style="color: white; font-weight: bolder"
                >
                  Thêm vào giỏ hàng
                </button>
              </form>
            </div>

            <div class="card-info text-start ms-3 ps-2">
              <h4 class="mb-3 text-center">Đặc thù sản phẩm</h4>
              <ul class="list-unstyled">
                <li class="mb-2">
                  <i class="bi bi-check2-circle text-success me-2"></i>
                  Hoa tươi là sản phẩm tự nhiên, nghệ thuật và
                  <strong>thủ công</strong> nên sản phẩm thành phẩm sẽ chỉ giống
                  80–90% so với hình ảnh sẵn có.
                </li>
                <li class="mb-2">
                  <i class="bi bi-check2-circle text-success me-2"></i>
                  Một số hoa, lá phụ / phụ kiện trên mẫu có thể thay đổi tùy
                  thuộc vào tài nguyên đang có ở shop.
                </li>
                <li class="mb-2">
                  <i class="bi bi-check2-circle text-success me-2"></i>
                  Màu sắc của hoa thực tế có thể khác đôi chút do ánh sáng,
                  thiết bị hiển thị hoặc góc chụp.
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="card-info g-lg-3 m-5 p-5">
        <h4 class="mb-3">Mô tả</h4>
        <p th:text="*{description}"></p>
        <h4>Những ưu đãi khi đặt hoa tại Karina flower</h4>
        <ul class="list-unstyled fs-6 mb-4">
          <li class="mb-2">
            <i class="bi bi-check2-circle text-success me-2"></i>
            Chụp hình hoa thực tế trước khi giao
          </li>
          <li class="mb-2">
            <i class="bi bi-check2-circle text-success me-2"></i>
            Xuất hóa đơn GTGT +8% (Giá chưa gồm VAT)
          </li>
          <li class="mb-2">
            <i class="bi bi-check2-circle text-success me-2"></i>
            Tặng kèm bảng tên công ty, thiệp nội dung
          </li>
        </ul>
        <h4>Lưu ý</h4>
        <ul class="fs-6 list-unstyled">
          <li class="mb-2">
            <i class="bi bi-check2-circle text-success me-2"></i>

            Tùy khu vực, tùy mùa hoa, thời tiết nên sẽ có thay đổi đối với mẫu
            hoa, trước khi thực hiện thay đổi sẽ báo trước cho khách hàng.
          </li>
          <li class="mb-2">
            <i class="bi bi-check2-circle text-success me-2"></i>

            Hoa tươi vào những ngày lễ: Valentine, Quốc tế phụ nữ, Phụ nữ Việt
            Nam, Giáng sinh, Tết,… giá hoa sẽ tăng dao động từ 20-30%. Thời điểm
            tăng giá hoa sẽ được tính từ 3 ngày trước khi lễ.
          </li>
        </ul>
      </div>
    </th:block>
    <div class="container">
      <div class="row m-4 p-4 g-lg-3">
        <div class="text text-secondary fs-3 mb-2 mt-4">Sản phẩm tương tự</div>
        <th:block
          th:each="product : ${#lists.size(productSimilar) > 8 ? productSimilar.subList(0, 8) : productSimilar}"
        >
          <div class="col-lg-3 col-md-6">
            <div class="product-card">
              <div class="product-img-container">
                <div class="flip-box">
                  <a
                    th:href="@{/detail(id=${product.id})}"
                    class="text-decoration-none"
                  >
                    <img
                      th:src="@{/images/{image}(image=*{product.image_url})}"
                      class="product-img front-img"
                    />
                    <img
                      th:src="@{/images/{image}(image=*{product.image_url2})}"
                      class="product-img back-img"
                    />
                  </a>
                </div>

                <div class="overlay">
                  <form
                    th:action="@{/cart/add}"
                    method="post"
                    style="display: inline"
                  >
                    <div class="add-to-cart-container">
                      <input
                        type="hidden"
                        name="productId"
                        th:value="${product.id}"
                      />
                      <input type="hidden" name="quantity" value="1" />
                      <button class="add-to-cart">
                        <i class="fa fa-shopping-cart"></i>
                      </button>
                      <div class="add-to-cart-text">Add to cart</div>
                    </div>
                  </form>
                </div>
              </div>

              <div class="product-info">
                <h4 th:text="${product.name}">Bó hoa cưới</h4>
                <p th:text="${product.price}">360,000₫</p>
                <div class="sizes">
                  <form th:action="@{/cart/add}" method="post">
                    <input
                      type="hidden"
                      name="productId"
                      th:value="${product.id}"
                    />
                    <input type="hidden" name="quantity" value="1" />
                    <button type="submit" class="size-btn">Mua ngay</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </th:block>
      </div>
    </div>

    <!-- Scripts -->
    <script th:src="@{/js/services-page.js}"></script>
    <script th:src="@{/js/pro-detail.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
      AOS.init();
      // Flower Petal Animation
      const particleContainer = document.getElementById("flower-particles");
      function createPetal() {
        const petal = document.createElement("div");
        petal.classList.add("petal");
        petal.style.left = Math.random() * 100 + "vw";
        petal.style.animationDuration = Math.random() * 8 + 7 + "s";
        petal.style.opacity = Math.random() * 0.4 + 0.3;
        petal.style.setProperty("--drift", Math.random() > 0.5 ? 1 : -1);
        particleContainer.appendChild(petal);
        setTimeout(() => petal.remove(), 15000);
      }
      setInterval(createPetal, 300);

      // Image Viewer and Zoom Functionality
      const mainImage = document.getElementById("main-image");
      const thumbnails = document.querySelectorAll(".thumbnail");
      const lightbox = document.getElementById("lightbox");
      const lightboxImage = document.getElementById("lightbox-image");
      const lightboxClose = document.getElementById("lightbox-close");

      // Thumbnail click to change main image
      thumbnails.forEach((thumbnail) => {
        thumbnail.addEventListener("click", () => {
          thumbnails.forEach((thumb) => thumb.classList.remove("active"));
          thumbnail.classList.add("active");
          mainImage.src = thumbnail.dataset.image;
        });
      });
    </script>
    <div th:insert="~{/fragments/chatbot}"></div>
  </body>
</html>
