<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sản phẩm</title>
    <link rel="stylesheet" th:href="@{/css/productCategory.css}" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <!-- AOS Animate On Scroll -->
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  </head>
  <body>
    <div class="container mt-4">
      <div class="d-flex justify-content-between align-items-center flex-wrap">
        <div>
          <th:block th:if="${pro_ca != null}">
            <h2 class="flowers" th:text="${pro_ca.name}"></h2>
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a href="/home" class="text-decoration-none text-secondary"
                    >Trang chủ</a
                  >
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                  <span class="flowers" th:text="${pro_ca.name}"></span>
                </li>
              </ol>
            </nav>
          </th:block>

          <!-- Breadcrumb cho trang tìm kiếm -->
          <th:block th:if="${searchKeyword != null}">
            <h2 class="flowers">Kết quả tìm kiếm</h2>
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a href="/home" class="text-decoration-none text-secondary"
                    >Trang chủ</a
                  >
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                  <span class="flowers"
                    >Tìm kiếm: <span th:text="${searchKeyword}"></span
                  ></span>
                </li>
              </ol>
            </nav>
          </th:block>
        </div>
      </div>
      <div class="col row align-items-start">
        <th:block th:if="${pro_ca != null}">
          <aside class="card col-3 bg-light p-3 border-0">
            <form>
              <h3>Lọc sản phẩm</h3>
              <!-- Mức gía -->
              <div>
                <h4 class="filter-title">Mức Giá</h4>
                <div class="filter-content">
                  <ul class="filter-items">
                    <li class="filter-item">
                      <a
                        th:href="@{/ProductUser(id=${pro_ca.id},min=0,max=200000,filter=price)}"
                        rel="nofollow"
                        role="button"
                        class="price-range"
                      >
                        <span>0 - 200.000 VND</span>
                      </a>
                    </li>
                    <li class="filter-item">
                      <a
                        th:href="@{/ProductUser(id=${pro_ca.id},min=200000,max=500000,filter=price)}"
                        rel="nofollow"
                        role="button"
                        class="price-range"
                      >
                        <span>200.000 VND - 500.000 VND</span>
                      </a>
                    </li>
                    <li class="filter-item">
                      <a
                        th:href="@{/ProductUser(id=${pro_ca.id},min=500000,max=10000000,filter=price)}"
                        rel="nofollow"
                        role="button"
                        class="price-range"
                      >
                        <span>>=500.000 VND</span>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <!-- Màu sắc -->
              <div>
                <h4 class="filter-title mt-4 mb-4">Màu sắc</h4>
                <div class="d-flex gap-3 flex-wrap">
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Đỏ,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #ff6961"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Hồng,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #ffb6c1"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Vàng,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #ffeb3b"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Xanh+dương,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #64b5f6"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Xanh,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #35e67f"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Trắng,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #ffffff; border: 1px solid #ddd"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Tím,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #c084fc"
                    ></span>
                  </a>
                  <a
                    th:href="@{/ProductUser(id=${pro_ca.id},color=Cam,filter=color)}"
                    class="color-link"
                    role="button"
                    rel="nofollow"
                  >
                    <span
                      class="color-circle"
                      style="background-color: #f4a261"
                    ></span>
                  </a>
                </div>
              </div>
              <!-- Loại hoa -->
              <div>
                <h4 class="filter-title mt-4 mb-4">Loại hoa</h4>
                <div class="filter-content">
                  <ul class="filter-items">
                    <th:block th:each="item:${categogies}">
                      <li class="filter-item filter-text mt-2 mb-2">
                        <a
                          th:href="@{/ProductUser(id=${pro_ca.id},categoryId=${item.id},filter=ca_id)}"
                          rel="nofollow"
                          role="button"
                          class="term-label"
                          th:text="${item.name}"
                        ></a>
                      </li>
                    </th:block>
                  </ul>
                </div>
              </div>
            </form>
          </aside>
        </th:block>
        <article th:class="${pro_ca != null} ? 'col-9' : 'col-12'">
          <!-- Thông báo tìm kiếm -->
          <th:block th:if="${searchMessage != null}">
            <div
              class="alert alert-info alert-dismissible fade show mb-4"
              role="alert"
            >
              <i class="fas fa-search me-2"></i>
              <span th:text="${searchMessage}"></span>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="alert"
                aria-label="Close"
              ></button>
            </div>
          </th:block>

          <!-- Thông báo lỗi -->
          <th:block th:if="${error != null}">
            <div
              class="alert alert-danger alert-dismissible fade show mb-4"
              role="alert"
            >
              <i class="fas fa-exclamation-triangle me-2"></i>
              <span th:text="${error}"></span>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="alert"
                aria-label="Close"
              ></button>
            </div>
          </th:block>

          <div class="row">
            <th:block th:each="item:${page.content}">
              <div class="col-md-3 mb-4">
                <div
                  class="card product-card border-0 shadow-sm rounded-4 overflow-hidden text-center"
                >
                  <a
                    th:href="@{/detail(id=${item.id})}"
                    class="text-decoration-none"
                  >
                    <div class="card-img-box">
                      <div class="card-img-inner">
                        <img
                          th:src="@{/images/{image}(image=${item.image_url})}"
                          alt="front"
                          class="card-img card-img-front"
                        />
                        <img
                          th:src="@{/images/{image}(image=${item.image_url})}"
                          alt="back"
                          class="card-img card-img-back"
                        />
                      </div>
                    </div>

                    <div class="card-body p-3">
                      <span
                        class="text-muted small d-block mb-1"
                        th:text="${item.id}"
                      ></span>
                      <h6
                        class="fw-semibold text-dark mb-2"
                        th:text="${item.name}"
                      ></h6>

                      <!-- Có giảm giá -->
                      <th:block
                        th:if="${item.discountPercent != null && item.discountPercent > 0}"
                      >
                        <span
                          class="fw-bold text-danger d-block"
                          th:text="${#numbers.formatDecimal(item.getPriceAfterDiscount(), 0, 'COMMA', 0, 'POINT')} + ' VND'"
                        ></span>
                        <span
                          class="text-muted text-decoration-line-through small"
                          th:text="${#numbers.formatDecimal(item.price, 0, 'COMMA', 0, 'POINT')} + ' VND'"
                        ></span>
                      </th:block>

                      <!-- Không có giảm giá -->
                      <th:block
                        th:if="${item.discountPercent == null || item.discountPercent == 0}"
                      >
                        <span
                          class="fw-bold text-muted d-block"
                          th:text="${#numbers.formatDecimal(item.price, 0, 'COMMA', 0, 'POINT')} + ' VND'"
                        ></span>
                      </th:block>
                    </div>
                  </a>
                </div>
              </div>
            </th:block>
          </div>
          <th:block th:if="${pro_ca != null}">
            <div class="container">
              <nav aria-label="Phân trang sản phẩm">
                <ul class="page-numbers nav-pagination links text-center">
                  <li>
                    <a
                      class="btn"
                      th:href="@{/ProductUser(id=${pro_ca.id}, p=0, min=${min}, max=${max}, filter=${filter})}"
                      th:classappend="${page.number == 0} ? 'disabled' : ''"
                      >First</a
                    >
                  </li>
                  <li>
                    <a
                      class="btn"
                      th:href="@{/ProductUser(id=${pro_ca.id}, p=${page.number - 1}, min=${min}, max=${max}, filter=${filter})}"
                      th:classappend="${page.number == 0} ? 'disabled' : ''"
                      ><i class="fas fa-angle-left"></i
                    ></a>
                  </li>
                  <li
                    th:each="i : ${#numbers.sequence(0, page.totalPages - 1)}"
                  >
                    <a
                      class="btn"
                      th:href="@{/ProductUser(id=${pro_ca.id}, p=${i}, min=${min}, max=${max}, filter=${filter})}"
                      th:classappend="${i == page.number} ? 'active' : ''"
                      th:text="${i + 1}"
                    ></a>
                  </li>
                  <li>
                    <a
                      class="btn"
                      th:href="@{/ProductUser(id=${pro_ca.id}, p=${page.number + 1}, min=${min}, max=${max}, filter=${filter})}"
                      th:classappend="${page.number == page.totalPages - 1} ? 'disabled' : ''"
                      ><i class="fas fa-angle-right"></i
                    ></a>
                  </li>
                  <li>
                    <a
                      class="btn"
                      th:href="@{/ProductUser(id=${pro_ca.id}, p=${page.totalPages - 1}, min=${min}, max=${max}, filter=${filter})}"
                      th:classappend="${page.number == page.totalPages - 1} ? 'disabled' : ''"
                      >Last</a
                    >
                  </li>
                </ul>
              </nav>
            </div>
          </th:block>
          <th:block th:if="${pro_ca == null}">
            <div class="container">
              <nav aria-label="Phân trang tìm kiếm">
                <ul class="page-numbers nav-pagination links text-center">
                  <li>
                    <a
                      class="btn"
                      th:href="@{/search(keyword=${searchKeyword}, p=0)}"
                      th:classappend="${page.number == 0} ? 'disabled' : ''"
                      >First</a
                    >
                  </li>
                  <li>
                    <a
                      class="btn"
                      th:href="@{/search(keyword=${searchKeyword}, p=${page.number - 1})}"
                      th:classappend="${page.number == 0} ? 'disabled' : ''"
                      ><i class="fas fa-angle-left"></i
                    ></a>
                  </li>
                  <li
                    th:each="i : ${#numbers.sequence(0, page.totalPages - 1)}"
                  >
                    <a
                      class="btn"
                      th:href="@{/search(keyword=${searchKeyword}, p=${i})}"
                      th:classappend="${i == page.number} ? 'active' : ''"
                      th:text="${i + 1}"
                    ></a>
                  </li>
                  <li>
                    <a
                      class="btn"
                      th:href="@{/search(keyword=${searchKeyword}, p=${page.number + 1})}"
                      th:classappend="${page.number == page.totalPages - 1} ? 'disabled' : ''"
                      ><i class="fas fa-angle-right"></i
                    ></a>
                  </li>
                  <li>
                    <a
                      class="btn"
                      th:href="@{/search(keyword=${searchKeyword}, p=${page.totalPages - 1})}"
                      th:classappend="${page.number == page.totalPages - 1} ? 'disabled' : ''"
                      >Last</a
                    >
                  </li>
                </ul>
              </nav>
            </div>
          </th:block>
        </article>
      </div>
      <div class="container">
        <div class="text">Sản phẩm hot của các danh mục khác</div>
        <div class="row">
          <!-- Card 1 -->
          <th:block th:each="item:${hotProductsOtherCategories}">
            <div class="col-lg-3 col-md-6">
              <div class="product-card">
                <div class="product-img-container">
                  <div class="flip-box">
                    <img
                      th:src="@{/images/{image}(image=${item.image_url})}"
                      class="product-img front-img"
                    />
                    <img
                      th:src="@{/images/{image}(image=${item.image_url})}"
                      class="product-img back-img"
                    />
                  </div>

                  <div class="overlay">
                    <div class="add-to-cart-container">
                      <button class="add-to-cart">
                        <i class="fa fa-shopping-cart"></i>
                      </button>
                      <div class="add-to-cart-text">Add to cart</div>
                    </div>
                  </div>
                </div>
                <div class="product-info">
                  <h4 th:text="${item.name}">Bó hoa cưới</h4>
                  <p th:text="${item.price}">360,000₫</p>
                  <div class="sizes">
                    <button class="size-btn">Mua ngay</button>
                  </div>
                </div>
              </div>
            </div>
          </th:block>
          <!-- 2 -->
        </div>
      </div>
    </div>
<<<<<<< HEAD

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- AOS Animate On Scroll -->
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>

    <!-- Custom JavaScript -->
    <script>
      // Khởi tạo AOS
      AOS.init();

      // Xử lý tìm kiếm nâng cao
      document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.querySelector('input[name="keyword"]');
        const searchForm = document.querySelector(".search-form");

        if (searchInput && searchForm) {
          // Tự động submit form khi nhấn Enter
          searchInput.addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              e.preventDefault();
              if (this.value.trim() !== "") {
                searchForm.submit();
              }
            }
          });

          // Focus vào ô tìm kiếm khi load trang
          if (window.location.pathname === "/search") {
            searchInput.focus();
          }
        }

        // Xử lý đóng alert
        const closeButtons = document.querySelectorAll(".btn-close");
        closeButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const alert = this.closest(".alert");
            if (alert) {
              alert.remove();
            }
          });
        });

        // Auto-hide alerts sau 5 giây
        const alerts = document.querySelectorAll(".alert");
        alerts.forEach((alert) => {
          setTimeout(() => {
            if (alert && alert.parentNode) {
              alert.style.transition = "opacity 0.5s ease";
              alert.style.opacity = "0";
              setTimeout(() => {
                if (alert.parentNode) {
                  alert.remove();
                }
              }, 500);
            }
          }, 5000);
        });
      });
    </script>
=======
    </div>
     <script th:src="@{/js/services-page.js}"></script>
>>>>>>> a68d5872ecf0f172b65642469c1051624dfff1d6
  </body>
  <!-- AOS JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

</html>
