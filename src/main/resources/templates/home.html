<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C·ª≠a H√†ng Hoa</title>

    <!-- Font Awesome for Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />

    <!-- Style css -->
    <link rel="stylesheet" th:href="@{/css/home.css}" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins&display=swap"
      rel="stylesheet"
    />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-overlay"></div>
      <div class="flower-particles" id="flower-particles"></div>
      <div class="hero-content">
        <h1 data-aos="fade-down">Karina Hana</h1>
        <p data-aos="fade-up" data-aos-delay="200">
          T·∫°o n√™n nh·ªØng kho·∫£nh kh·∫Øc ƒë√°ng nh·ªõ v·ªõi nh·ªØng thi·∫øt k·∫ø hoa tinh t·∫ø
        </p>
        <a
          href="#services"
          class="btn btn-primary"
          data-aos="fade-up"
          data-aos-delay="400"
          >Kh√°m Ph√° Ngay</a
        >
      </div>
    </section>
    <section class="features">
      <div class="feature-item" data-aos="fade-up">
        <i class="fa-solid fa-check"></i>
        <p>H√¨nh hoa th·∫≠t</p>
      </div>
      <div class="feature-item" data-aos="fade-up" data-aos-delay="100">
        <i class="fa-solid fa-heart"></i>
        <p>An to√†n, ƒë√°ng tin c·∫≠y</p>
      </div>
      <div class="feature-item" data-aos="fade-up" data-aos-delay="200">
        <i class="fa-solid fa-car-side"></i>
        <p>Giao hoa nhanh</p>
      </div>
      <div class="feature-item" data-aos="fade-up" data-aos-delay="300">
        <i class="fa-solid fa-wallet"></i>
        <p>Thanh to√°n d·ªÖ</p>
      </div>
    </section>

    <section class="new-flowers-section my-5 text-center">
      <h2 class="mb-4" data-aos="fade-up" data-aos-duration="800">
        S·∫£n ph·∫©m m·ªõi theo t·ª´ng danh m·ª•c
      </h2>
      <div class="new-flower-grid-wrapper">
        <div class="new-flower-grid">
          <div
            th:each="product, iterStat : ${latestProducts}"
            class="new-flower-card"
            data-aos="zoom-in-up"
            th:data-aos-delay="${iterStat.index * 100}"
            data-aos-easing="ease-out-back"
          >
            <a
              th:href="@{/detail(id=${product.id})}"
              class="text-decoration-none"
            >
              <img
                th:src="${product.image_url != null and product.image_url != '' ? '/images/' + product.image_url : '/images/logo.png'}"
                th:alt="${product.name}"
                onerror="this.src='/images/logo.png'; this.onerror=null;"
                style="width: 100%; height: 200px; object-fit: cover"
              />
            </a>
            <!-- Hi·ªÉn th·ªã t√™n danh m·ª•c s·∫£n ph·∫©m -->
            <div
              class="product-category-name"
              th:text="${product.productCategory != null ? product.productCategory.name : 'Kh√¥ng c√≥ danh m·ª•c'}"
              style="
                font-size: 0.9em;
                color: #666;
                margin-bottom: 5px;
                font-weight: 500;
              "
            >
              Danh m·ª•c
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="row m-2 my-4 align-items-center">
      <div class="promo-section d-flex flex-wrap align-items-center">
        <!-- PH·∫¶N H√åNH ·∫¢NH -->
        <div
          class="promo-images d-flex flex-wrap gap-3"
          data-aos="fade-right"
          data-aos-duration="1000"
        >
          <div class="promo-card">
            <span class="promo-tag">-10%</span>
            <img
              src="https://hoavily.com/uploads/file/Bai%20viet%202024/hoa-bang-tien-hoavlily.jpg"
              alt="S·∫£n ph·∫©m 1"
            />
          </div>
          <div class="promo-card">
            <span class="promo-tag">-15%</span>
            <img
              src="https://hoavily.com/uploads/file/Bai%20viet%202024/hoa-bang-tien-hoavlily.jpg"
              alt="S·∫£n ph·∫©m 2"
            />
          </div>
          <div class="promo-card">
            <span class="promo-tag">-20%</span>
            <img
              src="https://hoavily.com/uploads/file/Bai%20viet%202024/hoa-bang-tien-hoavlily.jpg"
              alt="S·∫£n ph·∫©m 3"
            />
          </div>
          <div class="promo-card">
            <span class="promo-tag">-25%</span>
            <img
              src="https://hoavily.com/uploads/file/Bai%20viet%202024/hoa-bang-tien-hoavlily.jpg"
              alt="S·∫£n ph·∫©m 4"
            />
          </div>
        </div>

        <!-- PH·∫¶N N·ªòI DUNG -->
        <div
          class="promo-text"
          data-aos="fade-left"
          data-aos-delay="200"
          data-aos-duration="1000"
        >
          <h2>Ch·ªçn hoa ƒë·∫πp, t·∫∑ng ng∆∞·ªùi th√¢n y√™u</h2>
          <h3>∆ØU ƒê√ÉI</h3>
          <p>
            üå∏ Hoa t∆∞∆°i nh√† FO ‚Äì N∆°i g·ª≠i g·∫Øm y√™u th∆∞∆°ng qua t·ª´ng c√°nh hoa t∆∞∆°i
            th·∫Øm, cam k·∫øt ch·∫•t l∆∞·ª£ng, t∆∞∆°i l√¢u, giao nhanh, ƒëa d·∫°ng m·∫´u m√£ cho
            m·ªçi d·ªãp ƒë·∫∑c bi·ªát! üíê‚ú®
          </p>
          <div class="promo-benefits d-flex gap-4">
            <div>
              <p>Mua t·ª´ 2 s·∫£n ph·∫©m gi·∫£m gi√° <strong>10%</strong></p>
              <p>Free ship n·ªôi th√†nh</p>
            </div>
            <div>
              <p>Mua t·ª´ 5 s·∫£n ph·∫©m gi·∫£m gi√° <strong>20%</strong></p>
            </div>
          </div>
          <a href="#"><span>Xem chi ti·∫øt</span></a>
        </div>
      </div>
    </section>

    <!-- Ph·∫ßn n√†y c√≥ th·ªÉ ƒë·∫∑t trong file dichvu_luoi4.html -->
    <section class="category-cards my-5 d-flex justify-content-center gap-5">
      <div class="image-grid">
        <div
          class="image-card"
          data-aos="zoom-in"
          data-aos-delay="0"
          data-aos-duration="800"
        >
          <img
            src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80"
            alt="·∫¢nh 1"
          />
          <div class="image-overlay"></div>
          <div class="image-overlay-button">Ph·ª• ki·ªán</div>
        </div>

        <div
          class="image-card"
          data-aos="zoom-in"
          data-aos-delay="100"
          data-aos-duration="800"
        >
          <img
            src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=600&q=80"
            alt="·∫¢nh 2"
          />
          <div class="image-overlay"></div>
          <div class="image-overlay-button">Kh√°m ph√°</div>
        </div>

        <div
          class="image-card"
          data-aos="zoom-in"
          data-aos-delay="200"
          data-aos-duration="800"
        >
          <img
            src="https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=600&q=80"
            alt="·∫¢nh 3"
          />
          <div class="image-overlay"></div>
          <div class="image-overlay-button">Mua ngay</div>
        </div>
      </div>
    </section>

    <section class="new-flowers-section my-5 text-center">
      <h2 class="mb-4" data-aos="fade-up" data-aos-duration="800">
        M·∫´u hoa s·ªë l∆∞·ª£ng nhi·ªÅu
      </h2>
      <div class="new-flower-grid-wrapper">
        <div class="new-flower-grid">
          <!-- Hi·ªÉn th·ªã d·ªØ li·ªáu s·∫£n ph·∫©m m·ªõi t·ª´ database -->
          <div
            th:each="product, iterStat : ${productQuantities}"
            class="new-flower-card"
            data-aos="zoom-in-up"
            th:data-aos-delay="${iterStat.index * 100}"
            data-aos-easing="ease-out-back"
          >
            <a
              th:href="@{/detail(id=${product.id})}"
              class="text-decoration-none"
            >
              <img
                th:src="${product.image_url != null and product.image_url != '' ? '/images/' + product.image_url : '/images/logo.png'}"
                th:alt="${product.name}"
                onerror="this.src='/images/logo.png'; this.onerror=null;"
                style="width: 100%; height: 200px; object-fit: cover"
              />
            </a>
            <div class="new-flower-name" th:text="${product.name}">T√™n hoa</div>
            <div
              class="new-flower-price"
              th:if="${product.discountPercent != null && product.discountPercent > 0}"
            >
              <span
                class="original-price"
                th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"
                >Gi√° g·ªëc</span
              >
              <span
                class="discount-price"
                th:text="${#numbers.formatDecimal(product.priceAfterDiscount, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"
                >Gi√° khuy·∫øn m√£i</span
              >
              <span
                class="discount-percent"
                th:text="'-' + ${product.discountPercent} + '%'"
                >-10%</span
              >
            </div>
            <div
              class="new-flower-price"
              th:unless="${product.discountPercent != null && product.discountPercent > 0}"
            >
              <span
                class="current-price"
                th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"
                >Gi√°</span
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="best-seller-section" data-aos="fade-in" data-aos-delay="0">
      <h2 data-aos="fade-in" data-aos-delay="100">Best Seller</h2>
      <div>
        <button
          class="filter-btn active"
          data-aos="fade-in"
          data-aos-delay="200"
          data-type="lang"
        >
          L√£ng hoa
        </button>
        <button
          class="filter-btn"
          data-aos="fade-in"
          data-aos-delay="200"
          data-type="gio"
        >
          Gi·ªè hoa
        </button>
        <button
          class="filter-btn"
          data-aos="fade-in"
          data-aos-delay="200"
          data-type="bo"
        >
          B√≥ hoa
        </button>
      </div>

      <div
        id="best-seller-grid"
        class="product-grid"
        data-aos="fade-in"
        data-aos-delay="200"
      >
        <!-- Dynamic products loaded from database -->
        <div
          th:each="product, iterStat : ${defaultBestSeller}"
          class="product-card"
          data-aos="fade-in"
          th:data-aos-delay="${300 + iterStat.index * 100}"
        >
          <div class="product-image">
            <a
              th:href="@{/detail(id=${product.id})}"
              class="text-decoration-none"
            >
              <img
                th:src="${product.image_url != null and product.image_url != '' ? '/images/' + product.image_url : '/images/logo.png'}"
                class="default-img"
                th:alt="${product.name}"
                onerror="this.src='/images/logo.png'; this.onerror=null;"
              />
              <img
                th:src="${product.image_url != null and product.image_url != '' ? '/images/' + product.image_url : '/images/logo.png'}"
                class="hover-img"
                th:alt="${product.name}"
                onerror="this.src='/images/logo.png'; this.onerror=null;"
              />
            </a>
            <div class="cart-icon-wrapper">
              <div class="cart-icon"><i class="fas fa-shopping-cart"></i></div>
              <div class="add-to-cart-text">Add To Cart</div>
            </div>
          </div>
          <div class="product-info">
            <div class="product-name" th:text="${product.name}">
              T√™n s·∫£n ph·∫©m
            </div>
            <div
              class="product-price"
              th:if="${product.discountPercent != null && product.discountPercent > 0}"
            >
              <span
                th:text="${#numbers.formatDecimal(product.priceAfterDiscount, 0, 'COMMA', 0, 'POINT')} + '‚Ç´'"
              ></span>
              <span
                style="text-decoration: line-through; color: #999"
                th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + '‚Ç´'"
              ></span>
            </div>
            <div
              class="product-price"
              th:unless="${product.discountPercent != null && product.discountPercent > 0}"
              th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + '‚Ç´'"
            >
              Gi√° s·∫£n ph·∫©m
            </div>
            <div class="product-size">
              S·ªë l∆∞·ª£ng: <span th:text="${product.quantity}">0</span>
            </div>
            <div
              class="product-size"
              th:text="${product.color != null ? product.color.name : 'N/A'}"
            >
              M√†u s·∫Øc
            </div>
          </div>
        </div>
      </div>
    </section>

    <section
      class="post-slider-section"
      data-aos="fade-up"
      data-aos-duration="800"
    >
      <h2 class="section-title" data-aos="fade-right" data-aos-delay="100">
        B√†i vi·∫øt
      </h2>
      <div class="swiper post-slider">
        <div class="swiper-wrapper">
          <div class="swiper-slide" th:each="post : ${posts}">
            <img
              th:src="${post.image != null && post.image != '' ? '/images/' + post.image : '/images/logo.png'}"
              alt="·∫¢nh b√†i vi·∫øt"
              class="avatar-img"
              style="object-fit: cover"
              onerror="this.src='/images/logo.png'; this.onerror=null;"
            />
            <div class="post-content">
              <h5 th:text="${post.title}">Ti√™u ƒë·ªÅ</h5>
              <span th:utext="${post.summary}"></span>
              <div
                class="d-flex justify-content-between align-items-center mt-2"
              >
                <small class="text-muted"
                  ><i class="fa fa-calendar"></i>
                  <span
                    th:text="${#temporals.format(post.postDate,'dd/MM/yyyy')}"
                    >01/01/25</span
                  ></small
                >
                <a th:href="@{/postDetail(id=${post.id})}" class="read-more-btn"
                  >Xem chi ti·∫øt</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="accessory-section">
      <h2>Ph·ª• ki·ªán</h2>
      <div class="product-grid" data-aos="fade-in" data-aos-delay="200">
        <!-- Begin Card -->
        <div class="product-card" data-aos="fade-in" data-aos-delay="300">
          <div class="product-image">
            <img
              src="https://th.bing.com/th/id/OIP.hL0olW_0qRVlrXhz8-RB4wHaI4?rs=1&pid=ImgDetMain"
              class="default-img"
            />
            <img
              src="https://saigonreview.vn/wp-content/uploads/2023/09/1695615220-shop-hoa-tuoi-quan-11-750x737.jpg"
              class="hover-img"
            />
            <div class="cart-icon-wrapper">
              <div class="cart-icon"><i class="fas fa-shopping-cart"></i></div>
              <div class="add-to-cart-text">Add To Cart</div>
            </div>
          </div>
          <div class="product-info">
            <div class="product-name">Terrarium ‚Äì Joy In Happy Garden 001</div>
            <div class="product-price">360,000‚Ç´ ‚Äì 450,000‚Ç´</div>
            <div class="product-size">size L</div>
            <div class="product-size">size M</div>
          </div>
        </div>
      </div>
    </section>

    <section
      class="service-section"
      data-aos="fade-up"
      data-aos-duration="1000"
    >
      <div class="service-container">
        <!-- H√¨nh ·∫£nh tr√¨nh chi·∫øu -->
        <div class="service-carousel" data-aos="zoom-in" data-aos-delay="100">
          <div class="carousel-images">
            <img
              src="https://picsum.photos/id/1018/600/400"
              alt="Slide 1"
              class="carousel-img active"
            />
            <img
              src="https://picsum.photos/id/1015/600/400"
              alt="Slide 2"
              class="carousel-img"
            />
            <img
              src="https://picsum.photos/id/1020/600/400"
              alt="Slide 3"
              class="carousel-img"
            />
            <img
              src="https://picsum.photos/id/1021/600/400"
              alt="Slide 4"
              class="carousel-img"
            />
            <img
              src="https://picsum.photos/id/1022/600/400"
              alt="Slide 5"
              class="carousel-img"
            />
          </div>
        </div>

        <!-- N·ªôi dung d·ªãch v·ª• -->
        <div class="service-content" data-aos="fade-left" data-aos-delay="300">
          <h2>D·ªãch v·ª•</h2>
          <p>
            <strong>FO flower shop</strong> l√† m·ªôt trong nh·ªØng ti·ªám hoa t∆∞∆°i uy
            t√≠n nh·∫•t t·∫°i ƒê√† N·∫µng, Vi·ªát Nam. FO cung c·∫•p d·ªãch v·ª• ƒë·∫∑t hoa online
            giao t·∫≠n n∆°i to√†n qu·ªëc, v·ªõi ch·∫•t l∆∞·ª£ng cao, gi√° t·ªët v√† ph·ª•c v·ª• t·∫≠n
            t√¢m.<br /><br />
            G·ª≠i t·∫∑ng y√™u th∆∞∆°ng th·∫≠t d·ªÖ d√†ng c√πng FO flower shop ‚Äì n∆°i m·ªói b√≥
            hoa l√† m·ªôt c√¢u chuy·ªán.
          </p>
          <a href="#" class="service-button"><span>Xem chi ti·∫øt</span></a>
        </div>
      </div>
    </section>

    <!-- Chatbot Popup -->
    <div id="chatbot-popup">
      <div id="chatbot-header">
        <span>üí¨ T∆∞ v·∫•n vi√™n FO Flower</span>
        <button id="chatbot-close">&times;</button>
      </div>
      <div id="chatbot-body">
        <div class="chatbot-message bot">
          Xin ch√†o! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?
        </div>
      </div>
      <div id="chatbot-input-area">
        <input type="text" id="chatbot-input" placeholder="Nh·∫≠p c√¢u h·ªèi..." />
        <button id="chatbot-send">G·ª≠i</button>
      </div>
    </div>
    <button id="chatbot-toggle">
      <i class="fa fa-comments"></i>
    </button>
    <style>
      #chatbot-popup {
        position: fixed;
        bottom: 90px;
        right: 30px;
        width: 320px;
        max-height: 420px;
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.18);
        display: none;
        flex-direction: column;
        z-index: 9999;
        overflow: hidden;
        font-family: "Poppins", Arial, sans-serif;
      }
      #chatbot-header {
        background: #7b2cbf;
        color: #fff;
        padding: 12px 16px;
        font-weight: 600;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      #chatbot-header button {
        background: none;
        border: none;
        color: #fff;
        font-size: 20px;
        cursor: pointer;
      }
      #chatbot-body {
        flex: 1;
        padding: 12px;
        overflow-y: auto;
        background: #f8f9fa;
        display: flex;
        flex-direction: column;
      }
      .chatbot-message {
        margin-bottom: 10px;
        padding: 8px 12px;
        border-radius: 12px;
        max-width: 85%;
        font-size: 15px;
        line-height: 1.5;
        word-break: break-word;
      }
      .chatbot-message.bot {
        background: #e0c3fc;
        color: #333;
        align-self: flex-start;
      }
      .chatbot-message.user {
        background: #b9fbc0;
        color: #333;
        align-self: flex-end;
        margin-left: auto;
      }
      #chatbot-input-area {
        display: flex;
        border-top: 1px solid #eee;
        background: #fff;
      }
      #chatbot-input {
        flex: 1;
        border: none;
        padding: 10px;
        font-size: 15px;
        outline: none;
        border-radius: 0 0 0 16px;
      }
      #chatbot-send {
        background: #7b2cbf;
        color: #fff;
        border: none;
        padding: 0 18px;
        font-size: 15px;
        cursor: pointer;
        border-radius: 0 0 16px 0;
      }
      #chatbot-toggle {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: #7b2cbf;
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 56px;
        height: 56px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.18);
        font-size: 26px;
        cursor: pointer;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    </style>
    <script>
      // Hi·ªÉn th·ªã/·∫©n popup chatbot
      document.getElementById("chatbot-toggle").onclick = function () {
        document.getElementById("chatbot-popup").style.display = "flex";
        this.style.display = "none";
      };
      document.getElementById("chatbot-close").onclick = function () {
        document.getElementById("chatbot-popup").style.display = "none";
        document.getElementById("chatbot-toggle").style.display = "flex";
      };

      // H√†m g·ª≠i tin nh·∫Øn v√† g·ªçi API
      async function sendChatbotMessage() {
        const input = document.getElementById("chatbot-input");
        const text = input.value.trim();
        if (!text) return;
        const body = document.getElementById("chatbot-body");

        // Hi·ªÉn th·ªã tin nh·∫Øn ng∆∞·ªùi d√πng
        const userMsg = document.createElement("div");
        userMsg.className = "chatbot-message user";
        userMsg.innerText = text;
        body.appendChild(userMsg);
        input.value = "";
        body.scrollTop = body.scrollHeight;

        // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒëang tr·∫£ l·ªùi
        const botMsg = document.createElement("div");
        botMsg.className = "chatbot-message bot";
        botMsg.innerText = "ƒêang tr·∫£ l·ªùi...";
        body.appendChild(botMsg);
        body.scrollTop = body.scrollHeight;

        // G·ªçi API
        try {
          const response = await fetch("http://localhost:3000/api/chat", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ question: text }),
          });
          if (!response.ok) throw new Error("L·ªói server");
          const data = await response.json();
          botMsg.innerText = data.answer || "Xin l·ªói, t√¥i ch∆∞a c√≥ c√¢u tr·∫£ l·ªùi.";
        } catch (e) {
          botMsg.innerText = "C√≥ l·ªói khi k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß.";
        }
      }

      // G·ª≠i tin nh·∫Øn khi nh·∫•n Enter
      document
        .getElementById("chatbot-input")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            e.preventDefault();
            sendChatbotMessage();
          }
        });
      document.getElementById("chatbot-send").onclick = sendChatbotMessage;
    </script>
       {% comment %} // copy den day thoi nhe  {% endcomment %}
    <script th:src="@{/js/home-page.js}"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  </body>
</html>
